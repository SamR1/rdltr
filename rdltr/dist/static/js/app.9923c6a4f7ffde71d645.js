webpackJsonp([1],{"1JyO":function(e,t){},"3mPE":function(e,t){},"6g1v":function(e,t){},"G/mi":function(e,t){},I09S:function(e,t){},NHnr:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=r("/5sW"),a={computed:{auth:function(){return this.$store.getters.isAuthenticated},username:function(){return this.$store.getters.user.username}},methods:{onLogout:function(){this.$store.dispatch("logout")},displayMenu:function(){console.log("displayMenu");var e=document.getElementById("responsive-navbar");"nav"===e.className?e.className+=" responsive":e.className="nav"}}},o={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("header",{attrs:{id:"header"}},[r("div",{staticClass:"logo"},[r("router-link",{attrs:{to:"/"}},[e._v("rdltr")])],1),e._v(" "),r("nav",{staticClass:"nav",attrs:{id:"responsive-navbar"},on:{click:e.displayMenu}},[r("ul",[e.auth?e._e():r("li",{staticClass:"menu"},[r("router-link",{attrs:{to:"/register"}},[e._v("Register")])],1),e._v(" "),e.auth?e._e():r("li",{staticClass:"menu"},[r("router-link",{attrs:{to:"/login"}},[e._v("Log in")])],1),e._v(" "),e.auth?r("li",{staticClass:"user menu"},[r("router-link",{attrs:{to:"/profile"}},[e._v(e._s(e.username))])],1):e._e(),e._v(" "),e.auth?r("li",{staticClass:"menu"},[r("span",{staticClass:"logout",on:{click:e.onLogout}},[e._v("Logout")])]):e._e()])]),e._v(" "),r("div",{attrs:{id:"nav-icon"},on:{click:e.displayMenu}},[r("i",{staticClass:"fa fa-bars"})])])},staticRenderFns:[]};var n={name:"app",components:{"app-header":r("VU/8")(a,o,!1,function(e){r("6g1v")},"data-v-7645a214",null).exports}},i={render:function(){var e=this.$createElement,t=this._self._c||e;return t("div",{attrs:{id:"app"}},[t("app-header"),this._v(" "),t("router-view")],1)},staticRenderFns:[]};var u=r("VU/8")(n,i,!1,function(e){r("G/mi")},null,null).exports,c=r("/ocq"),l={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"contnr",attrs:{id:"actionType"}},[r("div",{staticClass:"user-form"},[r("form",[r("div",{staticClass:"input"},[r("label",{attrs:{for:"username"}},[e._v("Username")]),e._v(" "),r("input",{directives:[{name:"model",rawName:"v-model",value:e.user.username,expression:"user.username"}],attrs:{id:"username",disabled:""},domProps:{value:e.user.username},on:{input:function(t){t.target.composing||e.$set(e.user,"username",t.target.value)}}})]),e._v(" "),r("div",{staticClass:"input"},[r("label",{attrs:{for:"email"}},[e._v("Email")]),e._v(" "),r("input",{directives:[{name:"model",rawName:"v-model",value:e.user.email,expression:"user.email"}],attrs:{type:"email",id:"email",disabled:""},domProps:{value:e.user.email},on:{input:function(t){t.target.composing||e.$set(e.user,"email",t.target.value)}}})]),e._v(" "),r("div",{staticClass:"input"},[r("label",{attrs:{for:"email"}},[e._v("Inscription date")]),e._v(" "),r("input",{directives:[{name:"model",rawName:"v-model",value:e.user.created_at,expression:"user.created_at"}],attrs:{id:"creationDate",disabled:""},domProps:{value:e.user.created_at},on:{input:function(t){t.target.composing||e.$set(e.user,"created_at",t.target.value)}}})]),e._v(" "),"editProfile"===e.actionType?r("div",{staticClass:"input"},[r("label",{attrs:{for:"password"}},[e._v("Old password")]),e._v(" "),r("input",{directives:[{name:"model",rawName:"v-model",value:e.oldPassword,expression:"oldPassword"}],attrs:{type:"password",id:"oldPassword",required:""},domProps:{value:e.oldPassword},on:{input:function(t){t.target.composing||(e.oldPassword=t.target.value)}}})]):e._e(),e._v(" "),"editProfile"===e.actionType?r("div",{staticClass:"input"},[r("label",{attrs:{for:"password"}},[e._v("New password")]),e._v(" "),r("input",{directives:[{name:"model",rawName:"v-model",value:e.newPassword,expression:"newPassword"}],attrs:{type:"password",id:"password",required:""},domProps:{value:e.newPassword},on:{input:function(t){t.target.composing||(e.newPassword=t.target.value)}}})]):e._e(),e._v(" "),"editProfile"===e.actionType?r("div",{staticClass:"input"},[r("label",{attrs:{for:"confirm-password"}},[e._v("Confirm New Password")]),e._v(" "),r("input",{directives:[{name:"model",rawName:"v-model",value:e.confirmNewPassword,expression:"confirmNewPassword"}],attrs:{type:"password",id:"confirm-password",required:""},domProps:{value:e.confirmNewPassword},on:{input:function(t){t.target.composing||(e.confirmNewPassword=t.target.value)}}})]):e._e(),e._v(" "),"editProfile"===e.actionType?r("div",{staticClass:"submit"},[r("button",{attrs:{type:"submit"},on:{click:function(t){t.preventDefault(),e.onSubmit()}}},[e._v("Submit")]),e._v(" "),r("router-link",{staticClass:"cancel",attrs:{to:"/profile",tag:"button"}},[e._v("Cancel")])],1):r("div",{staticClass:"submit"},[r("router-link",{attrs:{to:"/profile/edit",tag:"button"}},[e._v("Change password")])],1)]),e._v(" "),e.errMessage?r("p",{staticClass:"user-error"},[e._v(e._s(e.errMessage))]):e._e()])])},staticRenderFns:[]};var d=r("VU/8")({props:["actionType"],data:function(){return{oldPassword:"",newPassword:"",confirmNewPassword:""}},computed:{errMessage:function(){return this.$store.getters.userErrorMessage},user:function(){return this.$store.getters.user}},methods:{onSubmit:function(){var e=this,t={old_password:this.oldPassword,new_password:this.newPassword,new_password_conf:this.confirmNewPassword};this.$store.dispatch("updateProfile",t).then(function(){e.oldPassword="",e.newPassword="",e.confirmNewPassword=""})}}},l,!1,function(e){r("3mPE")},"data-v-8016edf4",null).exports,p={render:function(){var e=this.$createElement;return(this._self._c||e)("p",[this._v("404 - Not Found")])},staticRenderFns:[]};var m=r("VU/8")(null,p,!1,function(e){r("dkey")},"data-v-3ea2f417",null).exports,v={render:function(){this.$createElement;this._self._c;return this._m(0)},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{attrs:{id:"welcome"}},[t("h1",[this._v("rdltr")]),this._v(" "),t("p",[this._v('a simple "read-it later" app!')])])}]};var f=r("VU/8")(null,v,!1,function(e){r("I09S")},"data-v-646c334b",null).exports,h={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"contnr",attrs:{id:"actionType"}},[r("div",{staticClass:"user-form"},[r("form",{on:{submit:function(t){t.preventDefault(),e.onSubmit(e.actionType)}}},["register"===e.actionType?r("div",{staticClass:"input"},[r("label",{attrs:{for:"username"}},[e._v("Username")]),e._v(" "),r("input",{directives:[{name:"model",rawName:"v-model",value:e.username,expression:"username"}],attrs:{id:"username",required:""},domProps:{value:e.username},on:{input:function(t){t.target.composing||(e.username=t.target.value)}}})]):e._e(),e._v(" "),r("div",{staticClass:"input"},[r("label",{attrs:{for:"email"}},[e._v("Email")]),e._v(" "),r("input",{directives:[{name:"model",rawName:"v-model",value:e.email,expression:"email"}],attrs:{type:"email",id:"email",required:""},domProps:{value:e.email},on:{input:function(t){t.target.composing||(e.email=t.target.value)}}})]),e._v(" "),r("div",{staticClass:"input"},[r("label",{attrs:{for:"password"}},[e._v("Password")]),e._v(" "),r("input",{directives:[{name:"model",rawName:"v-model",value:e.password,expression:"password"}],attrs:{type:"password",id:"password",required:""},domProps:{value:e.password},on:{input:function(t){t.target.composing||(e.password=t.target.value)}}})]),e._v(" "),"register"===e.actionType?r("div",{staticClass:"input"},[r("label",{attrs:{for:"confirm-password"}},[e._v("Confirm Password")]),e._v(" "),r("input",{directives:[{name:"model",rawName:"v-model",value:e.confirmPassword,expression:"confirmPassword"}],attrs:{type:"password",id:"confirm-password",required:""},domProps:{value:e.confirmPassword},on:{input:function(t){t.target.composing||(e.confirmPassword=t.target.value)}}})]):e._e(),e._v(" "),e._m(0)]),e._v(" "),e.errMessage?r("p",{staticClass:"user-error"},[e._v(e._s(e.errMessage))]):e._e()])])},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"submit"},[t("button",{attrs:{type:"submit"}},[this._v("Submit")])])}]};var g=r("VU/8")({props:["actionType"],data:function(){return{username:"",email:"",password:"",confirmPassword:""}},computed:{errMessage:function(){return this.$store.getters.userErrorMessage}},methods:{onSubmit:function(e){var t={email:this.email,password:this.password};return"register"===e&&(t.username=this.username,t.password_conf=this.confirmPassword),this.$store.dispatch("loginOrRegister",{actionType:e,formData:t})}}},h,!1,function(e){r("1JyO")},"data-v-cee8237c",null).exports,w=r("NYxO"),_=r("mtWM"),P=r.n(_),b=P.a.create({baseURL:"http://localhost:5000/api"}),y=r("//Fk"),C=r.n(y),T=P.a.create({baseURL:"http://localhost:5000/api"});T.interceptors.request.use(function(e){if(M.state.user.authToken){var t="Bearer "+M.state.user.authToken;e.headers.Authorization!==t&&(e.headers.Authorization="Bearer "+M.state.user.authToken)}return e},function(e){return C.a.reject(e)});var E=T,k=function(e,t,r){return t.response?e("updateErrorMsg",t.response.data.message):e("updateErrorMsg",t.message?t.message:r)},N={state:{authToken:null,user:{},userErrorMessage:null},getters:{isAuthenticated:function(e){return null!==e.authToken},user:function(e){return e.user},userErrorMessage:function(e){return e.userErrorMessage}},mutations:{authUser:function(e,t){e.authToken=t,e.userErrorMessage=null},clearUserData:function(e,t){e.authToken=null,e.user={},e.userErrorMessage=null},updateErrorMsg:function(e,t){e.userErrorMessage=t},userProfile:function(e,t){e.user=t}},actions:{checkUserAuth:function(e){var t=e.commit,r=e.dispatch;window.localStorage.authToken&&(t("authUser",window.localStorage.authToken),r("getUserProfile"))},getUserProfile:function(e){var t=e.commit;E.get("auth/profile").then(function(e){"success"===e.data.status&&t("userProfile",e.data.user)}).catch(function(e){return k(t,e,"error on profile")})},loginOrRegister:function(e,t){var r=e.commit,s=e.dispatch;b.post("/auth/"+t.actionType,t.formData).then(function(e){if("success"===e.data.status){var t=e.data.auth_token;window.localStorage.setItem("authToken",t),r("authUser",t),s("getUserProfile"),x.replace("/")}}).catch(function(e){return k(r,e,"error on "+t.actionType)})},logout:function(e){(0,e.commit)("clearUserData"),localStorage.removeItem("authToken"),x.replace("/login")},updateProfile:function(e,t){var r=e.commit;e.dispatch;E.post("/auth/profile/edit",t).then(function(e){"success"===e.data.status&&x.replace("/profile")}).catch(function(e){return k(r,e,"error on password update")})}}};s.a.use(w.a);var M=new w.a.Store({state:{},mutations:{},actions:{},getters:{},modules:{user:N}});function U(e,t,r){M.dispatch("checkUserAuth").then(function(){return M.getters.isAuthenticated&&["/login","/register"].includes(e.path)?r("/"):M.getters.isAuthenticated||["/login","/register"].includes(e.path)?void 0:r("/login")}),r()}s.a.use(c.a);var $=[{path:"/",component:f,beforeEnter:U},{path:"/register",component:g,props:{actionType:"register"},beforeEnter:U},{path:"/login",component:g,props:{actionType:"login"},beforeEnter:U},{path:"/profile",component:d,props:{actionType:"viewProfile"},beforeEnter:U},{path:"/profile/edit",component:d,props:{actionType:"editProfile"},beforeEnter:U},{path:"*",component:m}],x=new c.a({mode:"history",routes:$});s.a.config.productionTip=!1,new s.a({el:"#app",router:x,store:M,render:function(e){return e(u)}})},dkey:function(e,t){}},["NHnr"]);
//# sourceMappingURL=app.9923c6a4f7ffde71d645.js.map